---
title: "1d historgram/density plot of cytometry data with ggplot2"
author: "Mike Jiang"
output:
  html_document:
    keep_md: yes
vignette: >    
  %\VignetteEngine{knitr::rmarkdown}
  %\VignetteIndexEntry{1d historgram/density plot of cytometry data with ggplot2}        
---

<script src="/rmarkdown-libs/header-attrs/header-attrs.js"></script>


<p><code>ggcyto</code> makes <code>ggplot2</code> to be able to work with <code>Cytometry</code> data, namely <code>flowSet/ncdfFlowSet</code> or <code>flowFrame</code> S4 objects.</p>
<pre class="r"><code>library(ggcyto)
data(GvHD)
fs &lt;- GvHD[subset(pData(GvHD), Patient %in%5:7 &amp; Visit %in% c(5:6))[[&quot;name&quot;]]]
fr &lt;- fs[[1]]</code></pre>
<div id="d-histogramdensityplot" class="section level2">
<h2>1d histogram/densityplot</h2>
<pre class="r"><code># histogram at raw scale
p &lt;- ggplot(fr, aes(x = `FL1-H`)) 
p + geom_histogram() </code></pre>
<p><img src="docs/examples/ggcyto/ggplot.flowSet.1d_files/figure-html/unnamed-chunk-3-1.png" width="672" /></p>
<pre class="r"><code># customize border colors and log scale 
p + geom_histogram(colour = &quot;white&quot;) + scale_x_log10()</code></pre>
<p><img src="docs/examples/ggcyto/ggplot.flowSet.1d_files/figure-html/unnamed-chunk-3-2.png" width="672" /></p>
<pre class="r"><code># change the bin width
p + geom_histogram(colour = &quot;white&quot;, binwidth = 1/20) + scale_x_log10()</code></pre>
<p><img src="docs/examples/ggcyto/ggplot.flowSet.1d_files/figure-html/unnamed-chunk-3-3.png" width="672" /></p>
<pre class="r"><code># logicle scale with default parameters setting (e.g. t = 262144)
p &lt;- p + geom_histogram(colour = &quot;white&quot;)
p + scale_x_logicle()</code></pre>
<p><img src="docs/examples/ggcyto/ggplot.flowSet.1d_files/figure-html/unnamed-chunk-3-4.png" width="672" /></p>
<pre class="r"><code># logicle scale with customized parameter
p + scale_x_logicle(t = 1e4, w = 0)</code></pre>
<p><img src="docs/examples/ggcyto/ggplot.flowSet.1d_files/figure-html/unnamed-chunk-3-5.png" width="672" /></p>
<pre class="r"><code># customized breaks
myBreaks &lt;- c(0, 10, 1e2, 1e3)
p  + scale_x_logicle(t = 1e4, w = 0, breaks = myBreaks)</code></pre>
<p><img src="docs/examples/ggcyto/ggplot.flowSet.1d_files/figure-html/unnamed-chunk-3-6.png" width="672" /></p>
<pre class="r"><code># remove marginal events
p  + scale_x_logicle(t = 1e4, w = 0, breaks = myBreaks, limits = c(2, 1e4))</code></pre>
<p><img src="docs/examples/ggcyto/ggplot.flowSet.1d_files/figure-html/unnamed-chunk-3-7.png" width="672" /></p>
<pre class="r"><code># other scales: flowJo_fasinh, flowJo_biexp
p + scale_x_flowJo_fasinh(t = 1e4)</code></pre>
<p><img src="docs/examples/ggcyto/ggplot.flowSet.1d_files/figure-html/unnamed-chunk-3-8.png" width="672" /></p>
<pre class="r"><code>p + scale_x_flowJo_biexp(maxValue = 1e4, widthBasis = 0)</code></pre>
<p><img src="docs/examples/ggcyto/ggplot.flowSet.1d_files/figure-html/unnamed-chunk-3-9.png" width="672" /></p>
<pre class="r"><code># save the scales
# myScales &lt;- scale_x_flowJo_biexp(maxValue = 1e4, widthBasis = 0)


# density  (default y is density)
p &lt;- ggplot(fr, aes(x = `FL1-H`)) 
p + geom_density() + scale_x_log10()</code></pre>
<p><img src="docs/examples/ggcyto/ggplot.flowSet.1d_files/figure-html/unnamed-chunk-3-10.png" width="672" /></p>
<pre class="r"><code># display area
p + geom_area(stat = &quot;density&quot;) + scale_x_log10()</code></pre>
<p><img src="docs/examples/ggcyto/ggplot.flowSet.1d_files/figure-html/unnamed-chunk-3-11.png" width="672" /></p>
<pre class="r"><code># display y as count
p + geom_area(stat = &quot;density&quot;, aes(y = ..count..))+ scale_x_log10()</code></pre>
<p><img src="docs/examples/ggcyto/ggplot.flowSet.1d_files/figure-html/unnamed-chunk-3-12.png" width="672" /></p>
<pre class="r"><code># histogram + density line
ggplot(fr, aes(x = `FL1-H`, y = ..density..)) + geom_histogram(colour = &quot;white&quot;) + geom_density(color = &quot;red&quot;) + scale_x_log10()</code></pre>
<p><img src="docs/examples/ggcyto/ggplot.flowSet.1d_files/figure-html/unnamed-chunk-3-13.png" width="672" /></p>
<pre class="r"><code># plot multiple samples
p &lt;- ggplot(fs, aes(x = `FL1-H`)) + geom_area(stat = &quot;density&quot;)+ scale_x_log10()
# facetting by sample names
p + facet_wrap(~name) </code></pre>
<p><img src="docs/examples/ggcyto/ggplot.flowSet.1d_files/figure-html/unnamed-chunk-3-14.png" width="672" /></p>
<pre class="r"><code># faceeting by other pheno data stored in fs
p + facet_grid(Patient~Visit)</code></pre>
<p><img src="docs/examples/ggcyto/ggplot.flowSet.1d_files/figure-html/unnamed-chunk-3-15.png" width="672" /></p>
<pre class="r"><code># fill with different colors
ggplot(fs, aes(x = `FL1-H`, fill = name)) + facet_wrap(~name) +  geom_density(alpha = 0.2)+ scale_x_log10()</code></pre>
<p><img src="docs/examples/ggcyto/ggplot.flowSet.1d_files/figure-html/unnamed-chunk-3-16.png" width="672" /></p>
<pre class="r"><code># or plot in the same panel
ggplot(fs, aes(x = `FL1-H`, fill = name)) + geom_density(alpha = 0.2) + scale_x_log10()</code></pre>
<p><img src="docs/examples/ggcyto/ggplot.flowSet.1d_files/figure-html/unnamed-chunk-3-17.png" width="672" /></p>
</div>
