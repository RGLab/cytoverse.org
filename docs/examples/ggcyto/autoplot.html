---
title: "Quick plot for cytometry data"
output:
  html_document:
    fig_height: 2
    fig_width: 5
    keep_md: true
vignette: >    
  %\VignetteIndexEntry{Quick plot for cytometry data}    
  %\VignetteEngine{knitr::rmarkdown}
---

<script src="/rmarkdown-libs/header-attrs/header-attrs.js"></script>


<pre class="r"><code>library(ggcyto)
dataDir &lt;- system.file(&quot;extdata&quot;,package=&quot;flowWorkspaceData&quot;)
gs &lt;- load_gs(list.files(dataDir, pattern = &quot;gs_bcell_auto&quot;,full = TRUE))
data(GvHD)
fs &lt;- GvHD[subset(pData(GvHD), Patient %in%5 &amp; Visit %in% c(5:6))[[&quot;name&quot;]]]</code></pre>
<div id="flowset" class="section level2">
<h2><code>flowSet</code></h2>
<p><code>geom_density</code> layer is used for one-dimensional plot.</p>
<pre class="r"><code>autoplot(fs, x = &#39;FSC-H&#39;)</code></pre>
<p><img src="docs/examples/ggcyto/autoplot_files/figure-html/unnamed-chunk-3-1.png" width="672" /></p>
<p><code>geom_hex</code> layer is added for 2d plot.</p>
<pre class="r"><code>autoplot(fs, x = &#39;FSC-H&#39;, y = &#39;SSC-H&#39;, bins = 64)</code></pre>
<p><img src="docs/examples/ggcyto/autoplot_files/figure-html/unnamed-chunk-4-1.png" width="672" />
## <code>flowFrame</code>
For the <code>flowFrame</code>, it can display one-dimensional plots for all channels by not supplying the <code>x</code> argument.</p>
<pre class="r"><code>autoplot(fs[[1]]) + labs_cyto(&quot;marker&quot;)</code></pre>
<p><img src="docs/examples/ggcyto/autoplot_files/figure-html/unnamed-chunk-5-1.png" width="672" /></p>
</div>
<div id="gatingset" class="section level2">
<h2><code>GatingSet</code></h2>
<pre class="r"><code>autoplot(gs, &quot;CD3&quot;, bins = 64)</code></pre>
<p><img src="docs/examples/ggcyto/autoplot_files/figure-html/unnamed-chunk-6-1.png" width="672" /></p>
<p>Here are some default settings applied:</p>
<ul>
<li>The instrument range is applied by default (through <code>ggcyto_par_set(limits = "instrument")</code>).</li>
<li>“CD3” gate is plotted aganst its the parent population: “Live”."</li>
<li>Axis labels are inverse transformed through <code>axis_x_inverse_trans/axis_x_inverse_trans</code>.</li>
</ul>
<p>Multiple gates that share the same parent can be plotted together.</p>
<pre class="r"><code>autoplot(gs, c(&quot;CD3&quot;, &quot;CD19&quot;), bins = 64)</code></pre>
<p><img src="docs/examples/ggcyto/autoplot_files/figure-html/unnamed-chunk-7-1.png" width="672" /></p>
</div>
<div id="gatinghierarchy" class="section level2">
<h2><code>GatingHierarchy</code></h2>
<p>Multiple cell populations with their asssociated gates can be plotted in different panels of the same plot.</p>
<pre class="r"><code>gh &lt;- gs[[1]]
nodes &lt;- gs_get_pop_paths(gh, path = &quot;auto&quot;)[c(3:6)]
nodes</code></pre>
<pre><code>## [1] &quot;lymph&quot; &quot;Live&quot;  &quot;CD20&quot;  &quot;CD19&quot;</code></pre>
<pre class="r"><code>autoplot(gh, nodes, bins = 64)</code></pre>
<p><img src="docs/examples/ggcyto/autoplot_files/figure-html/unnamed-chunk-8-1.png" width="384" /></p>
</div>
<div id="ggcyto_arrange" class="section level2">
<h2><code>ggcyto_arrange</code></h2>
<p>Optionally we can manually arrange it as a <code>gtable</code> object and manipulate the layout afterwards.</p>
<pre class="r"><code># get ggcyto_GatingLayout object from first sample
res &lt;- autoplot(gs[[1]], nodes, bins = 64)
class(res)</code></pre>
<pre><code>## [1] &quot;ggcyto_GatingLayout&quot;
## attr(,&quot;package&quot;)
## [1] &quot;ggcyto&quot;</code></pre>
<pre class="r"><code># arrange it as one-row gtable object 
gt &lt;- ggcyto_arrange(res, nrow = 1)
gt</code></pre>
<pre><code>## TableGrob (2 x 4) &quot;arrange&quot;: 5 grobs
##       z     cells    name                 grob
## lymph 1 (2-2,1-1) arrange       gtable[layout]
## Live  2 (2-2,2-2) arrange       gtable[layout]
## CD20  3 (2-2,3-3) arrange       gtable[layout]
## CD19  4 (2-2,4-4) arrange       gtable[layout]
##       5 (1-1,1-4) arrange text[GRID.text.1425]</code></pre>
<pre class="r"><code># do the same to the second sample
gt2 &lt;- ggcyto_arrange(autoplot(gs[[2]], nodes, bins = 64), nrow = 1)
# combine the two and print it on the sampe page
gt3 &lt;- gridExtra::gtable_rbind(gt, gt2)
plot(gt3)</code></pre>
<p><img src="docs/examples/ggcyto/autoplot_files/figure-html/unnamed-chunk-9-1.png" width="768" /></p>
</div>
